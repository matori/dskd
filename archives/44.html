<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta content="width=device-width" name="viewport">

  <title>Autoprefixerの@keyframes animation の処理に違和感があったけど、僕が間違っていた - dskd</title>

  <meta content="ポストプロセッサーのAutoprefixer、大変強力で素晴らしく便利なのだけど、@keyframesの処理には違和感があった。
" name="description">
  <meta content="Movable Type 6.1" name="generator">
  <meta content="http://dskd.jp/dist/img/blog-cover.png" itemprop="image">

  <meta content="Autoprefixerの@keyframes animation の処理に違和感があったけど、僕が間違っていた" property="og:title">
  <meta content="ポストプロセッサーのAutoprefixer、大変強力で素晴らしく便利なのだけど、@keyframesの処理には違和感があった。
" property="og:description">
  <meta content="http://dskd.jp/dist/img/blog-cover.png" property="og:image">
  <meta content="article" property="og:type">
  <meta content="http://dskd.jp/archives/44.html" property="og:url">
  <meta content="ja_JP" property="og:locale">
  <meta content="dskd" property="og:site_name">

  <!--#include virtual="/head-meta-twittercard.html" -->

  <link href="http://dskd.jp/archives/44.html" rel="canonical">
  <link href="http://dskd.jp/archives/44.html" itemprop="url">
  <!--#include virtual="/head-linkrel.html" -->
</head>
<body>
  <header class="global-header" role="banner">
    <nav class="site-navigation" role="navigation">
      <a class="logo" href="/"><img alt="dskd" src="/dist/svg/logo.svg" width="100" height="60"></a>
      <ul class="headlinks">
        <li><a href="/archives/">Archive</a></li>
        <li><a href="/demo/">Demo</a></li>
        <li><a href="/about.html">About</a></li>
      </ul>
    </nav>
  </header>

  <div class="content">
    <article class="entry" role="main">
      <footer class="entry-footer">
        <time datetime="2014-05-07T11:47:45+09:00">2014.05.07</time>
        <p itemprop="keywords"><a href="http://dskd.jp/archives/c9.html" class="tag">CSS</a></p>
      </footer>

      <h1 class="entry-title" itemprop="name">Autoprefixerの@keyframes animation の処理に違和感があったけど、僕が間違っていた</h1>
      <div class="entry-body" itemprop="articleBody">
        <div itemprop="description">
<p>ポストプロセッサーの<a href="https://github.com/ai/autoprefixer">Autoprefixer</a>、大変強力で素晴らしく便利なのだけど、<code>@keyframes</code>の処理には違和感があった。</p>

        </div>
        <div>
<p>以下の様なCSSルールセットがあるとする。<code>translate</code>で要素のY座標を+300pxするだけの簡単なアニメーション。<code>animation-deday</code>, <code>animation-iteration-count</code>, <code>animation-direction</code>は規定値ということでショートハンドで省略している。</p>

<pre><code data-language="css">.ugoku {
  animation: ugoku 0.5s ease-in;
}

@keyframes ugoku {
  0% {
    transform: translate(0px, 0px);
  }

  100% {
    transform: translate(0px, 300px);
  }
}</code></pre>

<p>これをAutoprefixerを使ってlast 2 versionsとか適当につけて実行すると、以下のように展開される。</p>

<pre><code data-language="css">.ugoku {
  -webkit-animation: ugoku 0.5s ease-in 0 1 normal;
  animation: ugoku 0.5s ease-in 0 1 normal;
}

@-webkit-keyframes ugoku {
  0% {
    -webkit-transform: translate(0px, 0px);
    transform: translate(0px, 0px);
  }

  100% {
    -webkit-transform: translate(0px, 300px);
    transform: translate(0px, 300px);
  }
}

@keyframes ugoku {
  0% {
    -webkit-transform: translate(0px, 0px);
    transform: translate(0px, 0px);
  }

  100% {
    -webkit-transform: translate(0px, 300px);
    transform: translate(0px, 300px);
  }
}</code></pre>

<p><code>@-webkit-keyframes</code>と<code>@keyframes</code>の両方に<code>-webkit-transform</code>と<code>transform</code>が入っている。僕はずっと、これはおかしいのではないかと思っていた。<code>@-webkit-keyframes@内には</code>-webkit-transform<code>だけでいい、</code>@keyframes<code>には</code>-webkit-transform`はいらない、以下のようになるべき、と。</p>

<pre><code data-language="css">.ugoku {
  -webkit-animation: ugoku 0.5s ease-in 0 1 normal;
  animation: ugoku 0.5s ease-in 0 1 normal;
}

@-webkit-keyframes ugoku {
  0% {
    -webkit-transform: translate(0px, 0px);
  }

  100% {
    -webkit-transform: translate(0px, 300px);
  }
}

@keyframes ugoku {
  0% {
    transform: translate(0px, 0px);
  }

  100% {
    transform: translate(0px, 300px);
  }
}</code></pre>

<p>スッキリやん！　FTWやん！　<strong>でも僕が間違っていた。</strong></p>

<p>というのも、<code>animation</code>と<code>@keyframes</code>と<code>transform</code>が同時にunprefixされる保障はない。もし<code>transform</code>がunprefixされないまま<code>@keyframes</code>がunprefixされたら、上記CSSではアニメーションが正常に動くかはわからない。だから<code>@keyframes</code>にもprefixが付与されていたのか。</p>

<p>Autoprefixer賢い！ Autoprefixerｻｲｺｰ!!</p>

        </div>
      </div>

      <aside class="social-buttons" role="complementary">
        <ul>
          <li class="twitter-tweet"><a href="https://twitter.com/intent/tweet?text=Autoprefixer%E3%81%AE%40keyframes%20animation%20%E3%81%AE%E5%87%A6%E7%90%86%E3%81%AB%E9%81%95%E5%92%8C%E6%84%9F%E3%81%8C%E3%81%82%E3%81%A3%E3%81%9F%E3%81%91%E3%81%A9%E3%80%81%E5%83%95%E3%81%8C%E9%96%93%E9%81%95%E3%81%A3%E3%81%A6%E3%81%84%E3%81%9F&url=http%3A%2F%2Fdskd.jp%2Farchives%2F44.html&via=dskd_jp&related=o_ti">Tweet</a></li>
          <li class="facebook-share"><a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fdskd.jp%2Farchives%2F44.html">Share on Facebook</a></li>
          <li class="googleplus-share"><a href="https://plus.google.com/share?url=http%3A%2F%2Fdskd.jp%2Farchives%2F44.html">Share on google+</a></li>
          <li class="hatena-bookmark"><a href="http://b.hatena.ne.jp/my/add.confirm?title=Autoprefixer%E3%81%AE%40keyframes%20animation%20%E3%81%AE%E5%87%A6%E7%90%86%E3%81%AB%E9%81%95%E5%92%8C%E6%84%9F%E3%81%8C%E3%81%82%E3%81%A3%E3%81%9F%E3%81%91%E3%81%A9%E3%80%81%E5%83%95%E3%81%8C%E9%96%93%E9%81%95%E3%81%A3%E3%81%A6%E3%81%84%E3%81%9F&amp;url=http%3A%2F%2Fdskd.jp%2Farchives%2F44.html">Bookmark on Hatena</a></li>
        </ul>
      </aside>
    </article>

    <nav class="neighbor">
      <ul class="neighborlinks">
        <li class="newer"><a href="http://dskd.jp/archives/45.html">人には難しい気がする機械の真偽</a></li>
        <li class="older"><a href="http://dskd.jp/archives/43.html">BEMまとめ奴</a></li>
      </ul>
    </nav>
  </div>

  <!--#include virtual="/global-footer.html" -->
</body>
</html>
